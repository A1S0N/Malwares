import "vt"

rule ddns
{
    meta:
        description = "Dynamic DNS Providers"
        author = "Alisson Moretto @A1S0N_"
        in_the_wild = true
        
    strings:
        $ddns_com_br = {64 64 6e 73 2e 63 6f 6d 2e 62 72}
        $ddns_net = {64 64 6e 73 2e 6e 65 74}
        $ddns_nu = {64 64 6e 73 2e 6e 75}
        $dhs_org = {64 68 73 2e 6f 72 67}
        $dns2go_com = {64 6e 73 32 67 6f 2e 63 6f 6d}
        $dnsdynamic_org = {64 6e 73 64 79 6e 61 6d 69 63 2e 6f 72 67}
        $dnsexit_com = {64 6e 73 65 78 69 74 2e 63 6f 6d}
        $dtdns_net = {64 74 64 6e 73 2e 6e 65 74}
        $duckdns_org = {64 75 63 6b 64 6e 73 2e 6f 72 67}
        $dyn_com = {64 79 6e 2e 63 6f 6d}
        $dynamic_dns_net = {64 79 6e 61 6d 69 63 2d 64 6e 73 2e 6e 65 74}
        $dyndns_com = {64 79 6e 64 6e 73 2e 63 6f 6d}
        $dyndns_org = {64 79 6e 64 6e 73 2e 6f 72 67}
        $dynip_com = {64 79 6e 69 70 2e 63 6f 6d}
        $dyns_cx = {64 79 6e 73 2e 63 78}
        $hopto_org = {68 6f 70 74 6f 2e 6f 72 67}
        $linkpc_net = {6c 69 6e 6b 70 63 2e 6e 65 74}
        $myddns_me = {6d 79 64 64 6e 73 2e 6d 65}
        $myftp_biz = {6d 79 66 74 70 2e 62 69 7a}
        $myftp_org = {6d 79 66 74 70 2e 6f 72 67}
        $ngrok_io = {6e 67 72 6f 6b 2e 69 6f}
        $no_ip_biz = {6e 6f 2d 69 70 2e 62 69 7a}
        $no_ip_info = {6e 6f 2d 69 70 2e 69 6e 66 6f}
        $no_ip_org = {6e 6f 2d 69 70 2e 6f 72 67}
        $noip_info = {6e 6f 69 70 2e 69 6e 66 6f}
        $nsytes_net = {6e 73 79 74 65 73 2e 6e 65 74}
        $osd_org = {6f 73 64 2e 6f 72 67}
        $portmap_host = {70 6f 72 74 6d 61 70 2e 68 6f 73 74}
        $portmap_io = {70 6f 72 74 6d 61 70 2e 69 6f}
        $publicvm_com = {70 75 62 6c 69 63 76 6d 2e 63 6f 6d}
        $sytes_net = {73 79 74 65 73 2e 6e 65 74}
        $zapto_org = {7a 61 70 74 6f 2e 6f 72 67}
    condition:
        1 of them and vt.metadata.new_file and vt.metadata.analysis_stats.malicious > 1
}
